<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.smhrd.mapper.ContestMapper">

	<!-- 사용 안할듯
	<select id="contestList" resultType="com.smhrd.entity.Contest">
		SELECT * FROM CONTESTS;
	</select>
	 -->
	 
	<select id="contestDetail" parameterType="int" resultType="com.smhrd.entity.Contest">
		SELECT * FROM CONTESTS WHERE CONTEST_IDX = #{contest_idx};
	</select>
	
	<!-- 검색을 위함 -->
	<select id="findContestsByFilters" parameterType="map" resultType="com.smhrd.entity.Contest">
        SELECT *
        FROM CONTESTS
        WHERE 1=1
        <if test="searchQuery != null">
            AND (TITLE LIKE CONCAT('%', #{searchQuery}, '%') OR CONTENT LIKE CONCAT('%', #{searchQuery}, '%'))
        </if>
        <if test="category != null">
            AND CATEGORY IN
            <foreach item="item" collection="category" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="app_qualification != null">
            AND APP_QUALIFICATION IN
            <foreach item="item" collection="app_qualification" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="prize != null">
            AND PRIZE IN
            <foreach item="item" collection="prize" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="app_method != null">
            AND APP_METHOD IN
            <foreach item="item" collection="app_method" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        ORDER BY ED_DT DESC
    </select>
	
</mapper>